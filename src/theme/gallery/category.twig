{% extends 'one-column' %}
{% import 'macros/macros' as macros %}

{% block header %}
    <div class="ContentHeader">
        <div class="Container">
            <h1 class="ContentHeader-title">Gallery</h1>
            <div class="ContentHeader-content">{{ category.categoryName }}</div>
        </div>
    </div>
{% endblock %}

{% block main %}
    <div class="u-margBottom3 u-textCenter">
        <a href="{{ appUrls.home }}">Main view</a>
        | <a href="{{ appUrls.itemList }}">Alternate view</a>
        {% for category in _app.categories %}
            | <a href="{{ category.url }}">{{ category.categoryName }}</a>
        {% endfor %}
    </div>
    {{ category.description }}
    {% if category.items %}
        {% spaceless %}
            <div class="Masonry">
                {% for item in category.items %}
                    {% set image = attribute(item.images|first, 'image') %}
                    {% set image.small.alt = item.itemName %}
                    {% set image.small.class = 'Masonry-image' %}
                    <div class="Masonry-item">
                        {% if category.categoryName == 'Alternate View 3' %}
                            {# Link directly to the large image instead of the item detail page #}
                            {% if item.video.urlInfo %}
                                {% set video = item.video.urlInfo|first %}
                                {% if image.small.src|length > 0 %}
                                    {% set videoImage = image.small %}
                                {% else %}
                                    {% set videoImage = video.thumbnail %}
                                    {% set videoImage.alt = item.itemName %}
                                    {% set videoImage.class = 'Masonry-image' %}
                                {% endif %}
                                <a href="{{ video.url }}" class="Masonry-link js-lightbox mfp-iframe" title="View video: {{ item.itemName }}">
                                    <div class="Masonry-imageWrap">{{ videoImage.tag }}</div>
                                    <div class="Masonry-play"></div>
                                    <div class="Masonry-title Masonry-title--overlay">{{ item.itemName }}</div>
                                </a>
                            {% else %}
                                <a href="{{ image.large.src }}" class="Masonry-link js-lightbox mfp-image" title="View larger image for {{ item.itemName }}">
                                    <div class="Masonry-imageWrap">{{ image.small.tag }}</div>
                                    <div class="Masonry-title Masonry-title--overlay">{{ item.itemName }}</div>
                                </a>
                            {% endif %}

                            {{ macros.loadMagnific() }}

                            {% inlinejs %}
                            loadjs.ready('magnific', {
                                success: function() {
                                    $(function() {
                                        $('.js-lightbox').magnificPopup({
                                            disableOn: 700,
                                            gallery:{
                                                enabled:true
                                            }
                                        });
                                    });
                                }
                            });
                            {% endinlinejs %}
                        {% else %}
                            <a href="{{ item.url }}" class="Masonry-link" title="View {{ item.itemName }}">
                                <div class="Masonry-imageWrap">{{ image.small.tag }}</div>
                                <div class="Masonry-imageWrap">{{ item.images.small.tag }}</div>
                                <div class="Masonry-title Masonry-title--overlay">{{ item.itemName }}</div>
                            </a>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        {% endspaceless %}
        {% include 'snippets/pagination' %}
    {% endif %}

{% endblock %}
